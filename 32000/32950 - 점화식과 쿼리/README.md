# 32950. [점화식과 쿼리](https://www.acmicpc.net/problem/32950)

| 티어 | 시간 제한 | 메모리 제한 | 제출 | 정답 | 맞힌 사람 | 정답 비율 |
|---|---|---|---:|---:|---:|---:|
| <img src="https://static.solved.ac/tier_small/21.svg" width="20px" /> | 3 초 (추가 시간 없음) | 1024 MB | 181 | 39 | 19 | 20.879% |

---

## 문제

수열 $ \{ x_n \} $이 정수 $n \ge 2$에 대해 점화식 $x_n = $ax_{n-1}$ + $bx_{n-2}$ + n^k $를 만족한다. 수열 $ \{ x_n \}$의 첫 두 항 $x_0, x_1$과 점화식이 주어질 때, $x_n$을 출력하는 프로그램을 작성하시오.

## 입력

첫째 줄에 정수 $x_0, x_1, a, b, k$가 공백으로 구분되어 주어진다. $(0 \le x_0, x_1, a, b, k \le 100 \, 000)$

둘째 줄에 정수 $Q$가 주어진다. $(1 \le Q \le 50 \, 000)$

셋째 줄부터 $Q$개의 줄에 걸쳐 한 줄에 하나씩, 정수 $n$이 주어진다. $(0 \le n \le $10^{18}$)$

## 출력

한 줄에 하나씩, $x_n$을 소수 $100 \, 003$으로 나눈 나머지를 출력한다.

## 예제

### 예제 입력 1

```
1 1 1 1 2
7
1
2
3
4
5
6
7
```

### 예제 출력 1

```
1
6
16
38
79
153
281
```

## 예제

### 예제 입력 2

```
1 2 4 99999 300
1
10000007
```

### 예제 출력 2

```
77817
```

## 노트

C/C++, Java 등의 언어에서 일부 변수를 $32$비트 정수형으로 선언한 경우 오버플로우가 발생할 수 있음에 유의하라.

## 출처

School
\> 
대전과학고등학교
\> 
제1회 대전과학고등학교 프로그래밍 경진대회 DSHStack
J번

- 문제를 만든 사람: wider93
- 문제를 검수한 사람: hyperbolic , ohwphil , sjhi00

## 알고리즘 분류

- 수학
- 정수론
- 분할 정복을 이용한 거듭제곱

